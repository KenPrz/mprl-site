import{s as I,T as C,r as F,o as P,d as f,e as p,f as n,u as o,Z as U,i as b,g as e,k as V,p as E,h as B,t as _,v as y,L as M,F as v,m as w,x as q,j as A}from"./app-DBlbD3Xe.js";import{_ as N}from"./AuthenticatedLayout-BCIr6F-9.js";import{_ as u}from"./InputError-Ld1BlpXP.js";import{u as $}from"./useFileSizeCheck-BL_QHxWQ.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BM8s6loa.js";import"./Dropdown-B2wAxoB0.js";const r=c=>(E("data-v-eb7e1898"),c=c(),B(),c),T=r(()=>e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Update Project",-1)),L={class:"py-12"},R={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-5"},G={class:"flex justify-start"},O=r(()=>e("i",{class:"fa-solid fa-arrow-left mr-2"},null,-1)),Z=r(()=>e("span",null,"Go Back",-1)),H={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg flex flex-col"},J={class:"w-full bg-white rounded-md p-4 shadow-md space-y-2"},K={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Q={class:"col-span-1"},W=r(()=>e("label",{for:"form-name",class:"block text-lg font-medium text-gray-700"},"Project Name",-1)),X={class:"col-span-1"},Y=r(()=>e("label",{for:"form-category",class:"block text-lg font-medium text-gray-700"},"Select Category",-1)),ee=r(()=>e("option",{disabled:""},"Category",-1)),se=["value"],te={class:"grid grid-cols-1 sm:grid-cols-1 gap-4"},oe={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ae={class:"col-span-1"},le={class:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-5"},re={class:"col-span-1"},ie=r(()=>e("label",{for:"form-system-size",class:"block text-lg font-medium text-gray-700"},"System Size",-1)),ne={class:"col-span-1"},de=r(()=>e("label",{for:"form-monthly-saving",class:"block text-lg font-medium text-gray-700"},"Monthly Saving",-1)),ce={class:"mt-5"},me=r(()=>e("label",{for:"form-description",class:"block text-lg font-medium text-gray-700"},"Project Description",-1)),ue={class:"col-span-1"},ge={class:"flex justify-between items-center"},fe=r(()=>e("label",{for:"file-upload",class:"block text-lg font-medium text-gray-700 p-3"},[A(" Image/s "),e("span",{class:"text-sm"},"(3 images max, 1.5 MB per image)")],-1)),pe={class:"flex justify-between items-center mt-2"},_e={class:"bg-main-500 hover:bg-main-600 px-2 py-1 rounded-lg text-white"},he=r(()=>e("label",{for:"file-upload",class:"flex cursor-pointer"},[e("i",{class:"fa-solid fa-plus text-xl"}),e("span",{class:"ml-1 hidden sm:flex items-center"},"Add Images")],-1)),ye={class:"bg-gray-300 rounded-lg w-full h-56 mt-2 flex items-center justify-center overflow-hidden"},be={class:"flex space-x-2"},ve=["src"],xe=["onClick"],we=r(()=>e("i",{class:"fa-solid fa-times"},null,-1)),je=[we],ke={__name:"Edit",props:{project:{type:Object,required:!0},categories:{type:Array,required:!0}},setup(c){const g=I(),{checkFileSize:j}=$(1.5),i=c,t=C({title:i.project.title||"",category_id:i.project.category_id||"",system_size:i.project.system_size||"",monthly_saving:i.project.monthly_saving||"",content:i.project.content||"",image:[],images_to_delete:[]}),d=F([]);P(()=>{i.project.images&&i.project.images.length>0&&(d.value=i.project.images.map(l=>({images:l.images,id:l.id}))),t.clearErrors()});function k(){t.post(route("admin.projects.update",i.project.id),{preserveScroll:!0,onSuccess:()=>{g.success("Project updated successfully!"),t.image=[],t.images_to_delete=[]},onError:l=>{g.error("Failed to update project. Please check the form and try again."),console.error(l)}})}function S(l){Array.from(l.target.files).forEach(s=>{if(j(s)){const m=new FileReader;m.onload=h=>{d.value.length===3&&x(2),d.value.push({images:h.target.result,id:null}),t.image.push(s)},m.readAsDataURL(s)}else g.error(`File "${s.name}" exceeds the 1.5 MB size limit.`)})}function x(l){const a=d.value[l];if(a.id)t.images_to_delete.push(a.id),g.info("Existing image marked for deletion. Save changes to confirm.");else{const s=t.image.findIndex((m,h)=>h===l-d.value.filter(z=>z.id).length);s!==-1&&t.image.splice(s,1),g.info("New image removed.")}d.value.splice(l,1)}return(l,a)=>(f(),p(v,null,[n(o(U),{title:"Admin: Projects"}),n(N,null,{header:b(()=>[T]),default:b(()=>[e("div",L,[e("div",R,[e("div",G,[n(o(V),{class:"bg-main-400 px-4 py-2 rounded-md text-white hover:bg-main-500 mb-2",href:l.route("admin.projects.index")},{default:b(()=>[O,Z]),_:1},8,["href"])]),e("div",H,[e("div",J,[e("div",K,[e("div",Q,[W,_(e("input",{id:"form-name",class:"w-full mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":a[0]||(a[0]=s=>o(t).title=s),type:"text",required:""},null,512),[[y,o(t).title]]),n(u,{class:"mt-2",message:o(t).errors.title},null,8,["message"])]),e("div",X,[Y,_(e("select",{id:"category",class:"w-full mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":a[1]||(a[1]=s=>o(t).category_id=s)},[ee,(f(!0),p(v,null,w(c.categories,s=>(f(),p("option",{key:s.id,value:s.id},q(s.name),9,se))),128))],512),[[M,o(t).category_id]]),n(u,{class:"mt-2",message:o(t).errors.category_id},null,8,["message"])])]),e("div",te,[e("div",oe,[e("div",ae,[e("div",le,[e("div",re,[ie,_(e("input",{id:"form-system-size",class:"w-full mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":a[2]||(a[2]=s=>o(t).system_size=s),type:"number",required:""},null,512),[[y,o(t).system_size]]),n(u,{class:"mt-2",message:o(t).errors.system_size},null,8,["message"])]),e("div",ne,[de,_(e("input",{id:"form-monthly-saving",class:"w-full mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":a[3]||(a[3]=s=>o(t).monthly_saving=s),type:"text",required:""},null,512),[[y,o(t).monthly_saving]]),n(u,{class:"mt-2",message:o(t).errors.monthly_saving},null,8,["message"])])]),e("div",ce,[me,_(e("textarea",{class:"w-full h-40 p-2 border border-gray-300 rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":a[4]||(a[4]=s=>o(t).content=s)},null,512),[[y,o(t).content]]),n(u,{class:"mt-2",message:o(t).errors.content},null,8,["message"])])]),e("div",ue,[e("div",ge,[fe,n(u,{class:"",message:o(t).errors.image},null,8,["message"]),e("div",pe,[e("div",_e,[e("input",{type:"file",multiple:"",onChange:S,class:"hidden",id:"file-upload"},null,32),he])])]),e("div",ye,[e("div",be,[(f(!0),p(v,null,w(d.value,(s,m)=>(f(),p("div",{key:m,class:"relative"},[e("img",{src:s.id?`/storage/${s.images}`:s.images,class:"w-32 h-32 object-cover rounded-lg mx-5"},null,8,ve),e("button",{onClick:h=>x(m),class:"absolute top-0 right-5 h-8 w-8 bg-red-500 text-white rounded-full p-1 transform translate-x-1/2 -translate-y-1/2"},je,8,xe)]))),128))])])])]),e("div",{class:"flex justify-end mt-5"},[e("button",{type:"button",class:"bg-main-500 hover:bg-main-600 p-3 text-white rounded-lg",onClick:k},"Update")])])])])])])]),_:1})],64))}},Ve=D(ke,[["__scopeId","data-v-eb7e1898"]]);export{Ve as default};
