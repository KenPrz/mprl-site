import{s as S,r as x,T as U,o as $,d as _,e as h,f as a,u as l,Z as F,i as g,g as s,k as T,j,p as D,h as M,t as N,v as A,x as P,q,F as y,m as z}from"./app-EkJNg7si.js";import{_ as L}from"./AuthenticatedLayout-Gln5m5Fm.js";import{s as R,V as O}from"./vue-multiselect.css_vue_type_style_index_0_src_true_lang-D_ddUJCv.js";import{_ as b}from"./InputError-CDJqJ9vG.js";import{_ as V}from"./Toggle-BvmlxkxW.js";import{E as Z}from"./Editor-DtDRiVtY.js";import{u as G}from"./useFileSizeCheck-DB3tfstT.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-WGTthfcB.js";import"./Dropdown-BjTmceD1.js";const u=m=>(D("data-v-b264cedc"),m=m(),M(),m),J=u(()=>s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Edit Blog",-1)),K={class:"py-12"},Q={class:"flex flex-col space-y-5 max-w-7xl mx-auto sm:px-6 lg:px-8"},W={class:"flex justify-start"},X={class:"w-full bg-white rounded-md p-4 shadow-md space-y-4"},Y={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},ee={class:"col-span-1 sm:col-span-2"},se=u(()=>s("label",{for:"form-title",class:"block text-lg font-medium text-gray-700"},"Title",-1)),te={class:"col-span-1 sm:col-span-2"},oe=u(()=>s("label",{for:"categories",class:"block text-lg font-medium text-gray-700"},"Categories",-1)),le={key:0,class:"multiselect__single"},ae={class:"flex flex-wrap space-x-4"},ie=u(()=>s("label",{for:"is_published",class:"block text-lg font-medium text-gray-700"},"Published",-1)),re=u(()=>s("label",{for:"is_featured",class:"block text-lg font-medium text-gray-700"},"Featured",-1)),de={class:"flex flex-wrap mt-4"},ne=["onClick"],ce=u(()=>s("i",{style:{color:"red"},class:"pi pi-times-circle"},null,-1)),ue=[ce],me=["src"],ge={class:"mt-4 flex justify-end"},pe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},fe={__name:"Edit",props:{categories:{type:Array,required:!0},blog:{type:Object,required:!0}},setup(m){const p=S(),{checkFileSize:k}=G(1.5),r=m,f=x([]),t=U({new_images:[],deleted_images:[],categories:r.blog.categories||[],title:r.blog.title,content:r.blog.body,is_published:r.blog.is_published,is_featured:r.blog.is_featured}),v=x(r.blog.body),d=x(r.blog.images.map(i=>({id:i.id,url:`/storage/${i.image}`})));function I(i){const o=i.target.files,e=[],n=[];Array.from(o).forEach(c=>{if(k(c)){e.push(c);const w=new FileReader;w.onload=E=>{n.push({id:null,url:E.target.result}),n.length===e.length&&(f.value.push(...e),d.value.push(...n))},w.readAsDataURL(c)}else p.error(`File "${c.name}" exceeds the 1.5 MB size limit.`)})}function C(i){const o=d.value.findIndex(n=>n.id===i),e=d.value[o];e.id&&t.deleted_images.push(e.id),d.value.splice(o,1),p.info("Image removed. Save changes to confirm deletion.")}function B(){f.value.length>0?t.new_images=f.value:t.new_images=null,t.content=v.value,t.categories=t.categories.map(i=>i.id),t.post(route("admin.blog.update",r.blog.id),{onSuccess:()=>{p.success("Blog post updated successfully!"),f.value=[]},onError:()=>{p.error("There was an error updating the blog post. Please try again.")}})}return $(()=>{t.clearErrors()}),(i,o)=>(_(),h(y,null,[a(l(F),{title:"Edit Blog"}),a(L,null,{header:g(()=>[J]),default:g(()=>[s("div",K,[s("div",Q,[s("div",W,[a(l(T),{class:"bg-main-400 px-2 py-1 rounded-md text-white hover:bg-main-500 mb-2",href:i.route("admin.blog.index")},{default:g(()=>[j(" Back ")]),_:1},8,["href"])]),s("div",X,[s("div",Y,[s("div",ee,[se,N(s("input",{id:"form-title",class:"w-full mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent","onUpdate:modelValue":o[0]||(o[0]=e=>l(t).title=e),type:"text"},null,512),[[A,l(t).title]]),a(b,{class:"mt-2",message:l(t).errors.title},null,8,["message"])]),s("div",te,[oe,a(l(R),{modelValue:l(t).categories,"onUpdate:modelValue":o[1]||(o[1]=e=>l(t).categories=e),options:r.categories,multiple:!0,"close-on-select":!1,"clear-on-select":!1,"preserve-search":!0,placeholder:"Select categories",label:"name","track-by":"id","preselect-first":!1},{selection:g(({values:e,search:n,isOpen:c})=>[e.length&&!c?(_(),h("span",le,P(e.length)+" categories selected ",1)):q("",!0)]),_:1},8,["modelValue","options"]),a(b,{class:"mt-2",message:l(t).errors.categories},null,8,["message"])])]),s("div",ae,[s("div",null,[ie,a(V,{modelValue:l(t).is_published,"onUpdate:modelValue":o[2]||(o[2]=e=>l(t).is_published=e)},null,8,["modelValue"])]),s("div",null,[re,a(V,{modelValue:l(t).is_featured,"onUpdate:modelValue":o[3]||(o[3]=e=>l(t).is_featured=e)},null,8,["modelValue"])])]),s("div",de,[a(l(O),{modelValue:d.value,"onUpdate:modelValue":o[4]||(o[4]=e=>d.value=e),tag:"div",class:"flex flex-wrap"},{default:g(()=>[(_(!0),h(y,null,z(d.value,e=>(_(),h("div",{key:e.id,class:"relative w-1/2 sm:w-1/3 md:w-1/4 p-2"},[s("button",{onClick:n=>C(e.id),class:"absolute -top-2 -right-2 text-white rounded-full p-1"},ue,8,ne),s("img",{src:e.url,class:"w-full h-auto rounded-md shadow-md cursor-move"},null,8,me)]))),128))]),_:1},8,["modelValue"]),a(b,{class:"mt-2",message:l(t).errors.images},null,8,["message"])]),s("div",ge,[s("button",{class:"bg-main-400 px-2 py-1 rounded-md text-white hover:bg-main-500",onClick:o[5]||(o[5]=e=>i.$refs.moreImages.click())},"Add More Images (max 1.5 MB each)"),s("input",{id:"more-images",ref:"moreImages",class:"hidden",type:"file",multiple:"",onChange:I},null,544)])]),s("div",pe,[a(b,{class:"mt-2",message:l(t).errors.content},null,8,["message"]),a(Z,{modelValue:v.value,"onUpdate:modelValue":o[6]||(o[6]=e=>v.value=e)},null,8,["modelValue"])]),s("div",{class:"flex justify-end mt-4"},[s("button",{class:"bg-main-400 px-2 py-1 rounded-md text-white hover:bg-main-500 mb-2",onClick:B}," Update ")])])])]),_:1})],64))}},Ce=H(fe,[["__scopeId","data-v-b264cedc"]]);export{Ce as default};
